<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <Metrilo_Analytics>
            <version>1.3.3</version>
        </Metrilo_Analytics>
    </modules>
    <frontend>
    	<layout>
            <updates>
                <metrilo_analytics>
                    <file>metrilo_analytics.xml</file>
                </metrilo_analytics>
            </updates>
        </layout>
        <events>
            <!-- Track AddToCart Changes Start -->
            <checkout_cart_product_add_after>
                <observers>
                    <add_to_cart>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_AddToCartObserver</class>
                        <method>addToCart</method>
                    </add_to_cart>
                </observers>
            </checkout_cart_product_add_after>
            <!-- Track AddToCart Changes END -->
            <!-- Track RemoveFromCart Changes START -->
            <sales_quote_remove_item>
                <observers>
                    <remove_from_cart>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_RemoveFromCartObserver</class>
                        <method>removeFromCart</method>
                    </remove_from_cart>
                </observers>
            </sales_quote_remove_item>
            <!-- Track RemoveFromCart Changes END -->
            <!-- Track Order Changes START -->
            <sales_order_place_after>
                <observers>
                    <place_order>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_OrderObserver</class>
                        <method>trackNewOrder</method>
                    </place_order>
                </observers>
            </sales_order_place_after>
            <!-- Track Order Changes END -->
            <customer_login>
                <observers>
                    <!-- Track Identify Login START -->
                    <metrilo_identify_customer_login>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_IdentifyCustomerObserver</class>
                        <method>identifyCustomer</method>
                    </metrilo_identify_customer_login>
                    <!-- Track Identify Login END -->
                </observers>
            </customer_login>
        </events>
    </frontend>
    <global>
        <events>
            <!-- Track Customer Changes (combining newsletter, admin-customer, user-customer, acc-register events) START -->
            <customer_save_after>
                <observers>
                    <metrilo_event_customer_update>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_CustomerObserver</class>
                        <method>customerUpdate</method>
                    </metrilo_event_customer_update>
                    <!-- Track Identify Customer Email Change START -->
                    <metrilo_identify_customer_update>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_IdentifyCustomerObserver</class>
                        <method>identifyCustomer</method>
                    </metrilo_identify_customer_update>
                    <!-- Track Identify Customer Email Change END -->
                </observers>
            </customer_save_after>
            <newsletter_subscriber_save_after>
                <observers>
                    <metrilo_event_subscriber_update>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_CustomerObserver</class>
                        <method>customerUpdate</method>
                    </metrilo_event_subscriber_update>
                </observers>
            </newsletter_subscriber_save_after>
            <!-- Track Customer Changes END -->
            <!-- Track Order Changes (combining admin order edit/create START -->
            <sales_order_save_after>
                <observers>
                    <metrilo_event_order>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_OrderObserver</class>
                        <method>orderUpdate</method>
                    </metrilo_event_order>
                    <!-- Track Identify Customer Order Change END -->
                    <metrilo_identify_customer_order>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_IdentifyCustomerObserver</class>
                        <method>identifyCustomer</method>
                    </metrilo_identify_customer_order>
                    <!-- Track Identify Customer Order Change END -->
                </observers>
            </sales_order_save_after>
            <!-- Track Order Changes END -->
            <!-- Track Config Changes START -->
            <admin_system_config_changed_section_metrilo_analytics_settings>
                <observers>
                    <modulename>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_ConfigObserver</class>
                        <method>saveConfig</method>
                    </modulename>
                </observers>
            </admin_system_config_changed_section_metrilo_analytics_settings>
            <!-- Track Config Changes END -->
        </events>
        <models>
            <metrilo_analytics>
                <class>Metrilo_Analytics_Model</class>
            </metrilo_analytics>
        </models>
    	<blocks>
            <metrilo_analytics>
                <class>Metrilo_Analytics_Block</class>
            </metrilo_analytics>
        </blocks>
        <helpers>
            <metrilo_analytics>
                <class>Metrilo_Analytics_Helper</class>
            </metrilo_analytics>
        </helpers>
    </global>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <custom_module after="Mage_Adminhtml">Metrilo_Analytics_Adminhtml</custom_module>
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin>
    <adminhtml>
        <layout>
            <updates>
                <metrilo_analytics>
                    <file>metrilo_analytics.xml</file>
                </metrilo_analytics>
            </updates>
        </layout>
        <events>
            <!-- Track Category Changes START -->
            <catalog_category_save_after>
                <observers>
                    <metrilo_event_category_update>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_CategoryObserver</class>
                        <method>categoryUpdate</method>
                    </metrilo_event_category_update>
                </observers>
            </catalog_category_save_after>
            <!-- Track Category Changes END -->
            <!-- Track Product Changes START -->
            <catalog_product_save_after>
                <observers>
                    <metrilo_event_category_update>
                        <type>singleton</type>
                        <class>Metrilo_Analytics_Model_ProductObserver</class>
                        <method>productUpdate</method>
                    </metrilo_event_category_update>
                </observers>
            </catalog_product_save_after>
            <!-- Track Product Changes END -->
        </events>
    </adminhtml>
    <default>
        <metrilo_analytics_settings>
            <settings>
                <enable>0</enable>
            </settings>
        </metrilo_analytics_settings>
    </default>
</config>
